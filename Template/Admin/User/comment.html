<include file="./Template/Admin/Common/user/header.html" />
<include file="./Template/Admin/Common/user/nav.html" />



<div id="page-wrapper">
    <div class="row">

        <div class="col-lg-12">
            <h1 class="page-header">预约详情</h1>
        </div>


        <div class="col-xs-12">
            <div class="row">
                <div class="col-xs-10 col-sm-4 col-xs-offset-1 col-sm-offset-0">
                    <div class="thumbnail">
                        <img src="__ROOT__/Uploads/{$teacher.avatar}" alt="{$appoint_info.teacher.name}">
                        <div class="caption">
                            <h4>{$teacher.name} <small> {$teacher.city}</small></h4>
                            <p>
                                <small>专业程度 {$teacher.professional_score}</small>
                                <br>
                                <small>服务态度 {$teacher.attitude_score}</small>
                            </p>
                            <p>
                                {$teacher.introduction}
                            </p>
                        </div>
                    </div>
                </div>
                <div class="col-xs-10 col-sm-8 col-xs-offset-1 col-sm-offset-0">
                    <form class="form-horizontal">
                        <div class="form-group">
                            <label class="col-sm-2 control-label">专业程度</label>
                            <div class="col-sm-10">
                                <i class="fa fa-star ca-cursor-point professional" id="comment-professional-1"></i>
                                <i class="fa fa-star ca-cursor-point professional" id="comment-professional-2"></i>
                                <i class="fa fa-star ca-cursor-point professional" id="comment-professional-3"></i>
                                <i class="fa fa-star ca-cursor-point professional" id="comment-professional-4"></i>
                                <i class="fa fa-star ca-cursor-point professional" id="comment-professional-5"></i>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">服务态度</label>
                            <div class="col-sm-10">
                                <i class="fa fa-star ca-cursor-point attitude" id="comment-attitude-1"></i>
                                <i class="fa fa-star ca-cursor-point attitude" id="comment-attitude-2"></i>
                                <i class="fa fa-star ca-cursor-point attitude" id="comment-attitude-3"></i>
                                <i class="fa fa-star ca-cursor-point attitude" id="comment-attitude-4"></i>
                                <i class="fa fa-star ca-cursor-point attitude" id="comment-attitude-5"></i>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">其他想说的</label>
                            <div class="col-sm-8">
                                <textarea class="form-control" rows="3" id="comment-content"></textarea>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-sm-offset-2 col-sm-8">
                                <button type="button" class="btn btn-primary" id="btn-comment">评价</button>
                            </div>
                        </div>
                    </form>
                </div>


            </div>
        </div>

    </div>
</div>



<include file="./Template/Admin/Common/user/footer.html" />

<script type="text/javascript">
    $(document).ready(function () {

        var attitude_score = 0;
        var professional_score = 0;

        initialize();


        /**
         * 页面初始化
         */
        function initialize() {
            comment_score();
            submit_comment();
        }



        function comment_score() {
            $('#comment-professional-1').click(function () {
                professional_score = 1;
                set_professional_score_zero();
                $('#comment-professional-1').addClass('ca-color-red');

            });
            $('#comment-professional-2').click(function () {
                professional_score = 2;
                set_professional_score_zero();
                $('#comment-professional-1').addClass('ca-color-red');
                $('#comment-professional-2').addClass('ca-color-red');
            });
            $('#comment-professional-3').click(function () {
                professional_score = 3;
                set_professional_score_zero();
                $('#comment-professional-1').addClass('ca-color-red');
                $('#comment-professional-2').addClass('ca-color-red');
                $('#comment-professional-3').addClass('ca-color-red');
            });
            $('#comment-professional-4').click(function () {
                professional_score = 4;
                set_professional_score_zero();
                $('#comment-professional-1').addClass('ca-color-red');
                $('#comment-professional-2').addClass('ca-color-red');
                $('#comment-professional-3').addClass('ca-color-red');
                $('#comment-professional-4').addClass('ca-color-red');
            });
            $('#comment-professional-5').click(function () {
                professional_score = 5;
                set_professional_score_zero();
                $('#comment-professional-1').addClass('ca-color-red');
                $('#comment-professional-2').addClass('ca-color-red');
                $('#comment-professional-3').addClass('ca-color-red');
                $('#comment-professional-4').addClass('ca-color-red');
                $('#comment-professional-5').addClass('ca-color-red');
            });
            $('#comment-attitude-1').click(function () {
                attitude_score = 1;
                set_attitude_score_zero();
                $('#comment-attitude-1').addClass('ca-color-red');
            });
            $('#comment-attitude-2').click(function () {
                attitude_score = 2;
                set_attitude_score_zero();
                $('#comment-attitude-1').addClass('ca-color-red');
                $('#comment-attitude-2').addClass('ca-color-red');
            });
            $('#comment-attitude-3').click(function () {
                attitude_score = 3;
                set_attitude_score_zero();
                $('#comment-attitude-1').addClass('ca-color-red');
                $('#comment-attitude-2').addClass('ca-color-red');
                $('#comment-attitude-3').addClass('ca-color-red');
            });
            $('#comment-attitude-4').click(function () {
                attitude_score = 4;
                set_attitude_score_zero();
                $('#comment-attitude-1').addClass('ca-color-red');
                $('#comment-attitude-2').addClass('ca-color-red');
                $('#comment-attitude-3').addClass('ca-color-red');
                $('#comment-attitude-4').addClass('ca-color-red');
            });
            $('#comment-attitude-5').click(function () {
                attitude_score = 5;
                set_attitude_score_zero();
                $('#comment-attitude-1').addClass('ca-color-red');
                $('#comment-attitude-2').addClass('ca-color-red');
                $('#comment-attitude-3').addClass('ca-color-red');
                $('#comment-attitude-4').addClass('ca-color-red');
                $('#comment-attitude-5').addClass('ca-color-red');
            });
        }


        // 将分数设置为 0
        function set_professional_score_zero() {
            $('.professional').each(function () {
               $(this).removeClass('ca-color-red');
            });
        }
        function set_attitude_score_zero() {
            $('.attitude').each(function () {
                $(this).removeClass('ca-color-red');
            });
        }


        /**
         * 提交评价
         */
        function submit_comment() {
            var data = {};

            data.user_id = '{$user.account_id}';
            data.teacher_id = '{$teacher.account_id}';
            data.appoint_id = '{$appoint_id}';
            var url = '{$comment_url}';
            console.log(url);
            $('#btn-comment').click(function () {
                data.content = $('#comment-content').val();
                data.attitude_score = attitude_score;
                data.professional_score = professional_score;
                console.log(data);
                $.post(url, data, function (res) {
                    //console.log(res);
                    if (res.status == 0) {
                        alert('评价成功！');
//                        location.reload();
                    } else {
                        alert('评价失败，请重试');
//                        location.reload();
                    }
                });
            });
        }

    });


</script>

<include file="./Template/Admin/Common/user/foot.html" />
